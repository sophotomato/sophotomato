---
title: 保留地址及检测方法
date: 2017-09-30 19:19:17
tags:
- 内核网络
- kernel
---
> 所有源码来自[kernel.org](https://www.kernel.org)
> 内核版本号3.10

所在目录/include/linux/in.h
<!-- more -->
```c {.line-numbers}
// - 0111 1111|xxxx xxxx|xxxx xxxx|xxxx xxxx - loopback地址
// - 127.x.x.x
static inline bool ipv4_is_loopback(__be32 addr)
{
	return (addr & htonl(0xff000000)) == htonl(0x7f000000);
}

// - 1110 xxxx|xxxx xxxx|xxxx xxxx|xxxx xxxx 多播地址
// - 224.x.x.x - 239.x.x.x
static inline bool ipv4_is_multicast(__be32 addr)
{
	return (addr & htonl(0xf0000000)) == htonl(0xe0000000);
}

// - 1110 0000|0000 0000|0000 0000|xxxx xxxx 本地多播
// - 224.0.0.x
static inline bool ipv4_is_local_multicast(__be32 addr)
{
	return (addr & htonl(0xffffff00)) == htonl(0xe0000000);
}

// - 255.255.255.255 本地广播
static inline bool ipv4_is_lbcast(__be32 addr)
{
	/* limited broadcast */
	return addr == htonl(INADDR_BROADCAST);
}

// - 0000 0000|xxxx xxxx|xxxx xxxx|xxxx xxxx - zeronet
// - 0.x.x.x
static inline bool ipv4_is_zeronet(__be32 addr)
{
	return (addr & htonl(0xff000000)) == htonl(0x00000000);
}

/* Special-Use IPv4 Addresses (RFC3330) */

// - 0000 1010|xxxx xxxx|xxxx xxxx|xxxx xxxx - private_10
// - 10.x.x.x
static inline bool ipv4_is_private_10(__be32 addr)
{
	return (addr & htonl(0xff000000)) == htonl(0x0a000000); // - 10.x.x.x
}

// - 1010 1100|0001 xxxx|xxxx xxxx|xxxx xxxx - private_172
// - 172.16.x.x - 172.31.x.x
static inline bool ipv4_is_private_172(__be32 addr)
{
	return (addr & htonl(0xfff00000)) == htonl(0xac100000);
}

// - 1100 0000|1010 1000|xxxx xxxx|xxxx xxxx - private_192
// - 192.168.x.x
static inline bool ipv4_is_private_192(__be32 addr)
{
	return (addr & htonl(0xffff0000)) == htonl(0xc0a80000);
}

// - 1010 1001|1111 1110|xxxx xxxx|xxxx xxxx
// - 169.254.x.x
static inline bool ipv4_is_linklocal_169(__be32 addr)
{
	return (addr & htonl(0xffff0000)) == htonl(0xa9fe0000);
}

// - 1100 0000|0101 1000|0110 0011|xxxx xxxx
// - 192.88.99.x
static inline bool ipv4_is_anycast_6to4(__be32 addr)
{
	return (addr & htonl(0xffffff00)) == htonl(0xc0586300);
}

// - 1100 0000|0000 0000|0000 0010|xxxx xxxx
// - 192.0.2.x
static inline bool ipv4_is_test_192(__be32 addr)
{
	return (addr & htonl(0xffffff00)) == htonl(0xc0000200);
}

// - 1100 0110|0001 001x|xxxx xxxx|xxxx xxxx
// - 198.18.x.x - 198.19.x.x
static inline bool ipv4_is_test_198(__be32 addr)
{
	return (addr & htonl(0xfffe0000)) == htonl(0xc6120000);
}
```
